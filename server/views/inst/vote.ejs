<% include partials/head %>

<style>
    .word {text-transform: capitalize;}
</style>

<% for(var bi=0; bi < books.length; bi++) { %>
    <% if(books[bi].votes.length == 0) continue; %>
    <div class="card" style="margin-bottom: 50px;">
        <div class="card-body">
            <h2 class="card-title">
                <%= books[bi].book_name %> <br>
                <small><%= books[bi].author_name %></small>
            </h2>
            <hr>
            <% for(var vi=0; vi < books[bi].votes.length; vi++) { 
                var meanings = JSON.parse('[' + books[bi].votes[vi].meanings + ']');%>
                <div id="word_id_<%= books[bi].votes[vi].word_id %>"></div>
                <h5 class="word"><%= books[bi].votes[vi].word %></h5>
                <p class="card-text">Sentence: <%= books[bi].votes[vi].sentence %></p>
                <ul>
                    <% for(var j=0; j < meanings.length; j++) { %>
                    <li>[<%= meanings[j].fl %>] <%= meanings[j].meaning %>

                    <button class="btn btn-link" onclick="vote(<%= books[bi].votes[vi].vote_id %>, <%= meanings[j].id %>)">Select</button>
                    </li>
                    <% } %>

                </ul><hr>
            <% } %>
        </div>
    </div>
<% } %>
<script type="text/javascript">
    function vote(vote_id, meaning_id){
        alert(vote_id + " " + meaning_id );
    //     $.post( "/vote/",
    //         {   book_name: book_name,
    //             author_name: author_name,
    //             user_id: user_id,
    //             word_id: word_id,
    //             meaning_id: meaning_id,
    //             sentence: sentence
    //         },
    //         function( res ) {
    //             console.log(res);
    //         }, "json"
    //     );
    }
</script>
<% include partials/foot %>